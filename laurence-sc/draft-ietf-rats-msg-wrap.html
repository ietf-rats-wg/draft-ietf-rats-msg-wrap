<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Cyrillic,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RATS Conceptual Messages Wrapper (CMW)</title>
<meta content="Henk Birkholz" name="author">
<meta content="Ned Smith" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="
       This document defines the RATS conceptual message wrapper (CMW) format, a type of encapsulation format that can be used for any RATS messages, such as Evidence, Attestation Results, Endorsements, and Reference Values.
Additionally, the document describes a collection type that enables the aggregation of one or more CMWs into a single message. 
       This document also defines corresponding CBOR tag, JSON Web Tokens (JWT) and CBOR Web Tokens (CWT) claims, as well as an X.509 extension.
These allow embedding the wrapped conceptual messages into CBOR-based protocols, web APIs, and PKIX protocols.
In addition, a Media Type and a CoAP Content-Format are defined for transporting CMWs in HTTP, MIME, CoAP and other Internet protocols. 
    " name="description">
<meta content="xml2rfc 3.23.0" name="generator">
<meta content="evidence" name="keyword">
<meta content="attestation results" name="keyword">
<meta content="endorsements" name="keyword">
<meta content="reference values" name="keyword">
<meta content="draft-ietf-rats-msg-wrap-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-rats-msg-wrap.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RATS CMW</td>
<td class="right">September 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Birkholz, et al.</td>
<td class="center">Expires 6 March 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Remote ATtestation ProcedureS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-rats-msg-wrap-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-09-02" class="published">2 September 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-03-06">6 March 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">N. Smith</div>
<div class="org">Intel</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">RATS Conceptual Messages Wrapper (CMW)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the RATS conceptual message wrapper (CMW) format, a type of encapsulation format that can be used for any RATS messages, such as Evidence, Attestation Results, Endorsements, and Reference Values.
Additionally, the document describes a collection type that enables the aggregation of one or more CMWs into a single message.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document also defines corresponding CBOR tag, JSON Web Tokens (JWT) and CBOR Web Tokens (CWT) claims, as well as an X.509 extension.
These allow embedding the wrapped conceptual messages into CBOR-based protocols, web APIs, and PKIX protocols.
In addition, a Media Type and a CoAP Content-Format are defined for transporting CMWs in HTTP, MIME, CoAP and other Internet protocols.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Remote ATtestation ProcedureS Working Group mailing list (rats@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/rats/">https://mailarchive.ietf.org/arch/browse/rats/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/thomas-fossati/draft-ftbs-rats-msg-wrap">https://github.com/thomas-fossati/draft-ftbs-rats-msg-wrap</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 March 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conceptual-message-wrapper-" class="internal xref">Conceptual Message Wrapper Encodings</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-cmw-record" class="internal xref">CMW Record</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-cmw-cbor-tags" class="internal xref">CMW CBOR Tags</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-use-of-pre-existing-cbor-ta" class="internal xref">Use of Pre-existing CBOR Tags</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-cmw-collections" class="internal xref">CMW Collections</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-cmw-collections-role-in-com" class="internal xref">CMW Collections' role in composite Attester topology</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-cmw-tunnel" class="internal xref">CMW Tunnel</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-cbor-to-json" class="internal xref">CBOR-to-JSON</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-json-to-cbor" class="internal xref">JSON-to-CBOR</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-decapsulation-algorithm" class="internal xref">Decapsulation Algorithm</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-json-record" class="internal xref">JSON Record</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-cbor-record" class="internal xref">CBOR Record</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-cbor-tag" class="internal xref">CBOR Tag</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-cbor-record-with-explicit-c" class="internal xref">CBOR Record with explicit CM indicator</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-cbor-collection" class="internal xref">CBOR Collection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-json-collection" class="internal xref">JSON Collection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-use-in-jwt" class="internal xref">Use in JWT</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-transporting-cmw-in-x509-me" class="internal xref">Transporting CMW in X.509 Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-compatibility-with-dice-con" class="internal xref">Compatibility with DICE <code>ConceptualMessageWrapper</code></a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-project-veraison" class="internal xref">Project Veraison</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-cwt-cmw-claim-registration" class="internal xref">CWT <code>cmw</code> Claim Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-jwt-cmw-claim-registration" class="internal xref">JWT <code>cmw</code> Claim Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-cbor-tag-registration" class="internal xref">CBOR Tag Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-rats-conceptual-message-wra" class="internal xref">RATS Conceptual Message Wrapper (CMW) Indicators Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-instructions-for-the-design" class="internal xref">Instructions for the Designated Expert</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-structure-of-entries" class="internal xref">Structure of Entries</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="auto internal xref">8.4.3</a>.  <a href="#name-provisional-registration" class="internal xref">Provisional Registration</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-media-types" class="internal xref">Media Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="auto internal xref">8.5.1</a>.  <a href="#name-application-cmwcbor" class="internal xref"><code>application/cmw+cbor</code></a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.2">
                    <p id="section-toc.1-1.8.2.5.2.2.1"><a href="#section-8.5.2" class="auto internal xref">8.5.2</a>.  <a href="#name-application-cmwjson" class="internal xref"><code>application/cmw+json</code></a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-coap-content-formats" class="internal xref">CoAP Content Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-new-smi-numbers-registratio" class="internal xref">New SMI Numbers Registrations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-collected-cddl" class="internal xref">Collected CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-registering-and-using-cmws" class="internal xref">Registering and Using CMWs</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-open-issues" class="internal xref">Open Issues</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The RATS architecture defines a handful of conceptual messages
(see <span><a href="https://rfc-editor.org/rfc/rfc9334#section-8" class="relref">Section 8</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>), such as Evidence and Attestation Results.
Each conceptual message can have multiple claims encoding and serialization
formats (<span><a href="https://rfc-editor.org/rfc/rfc9334#section-9" class="relref">Section 9</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>). Throughout their lifetime, RATS
conceptual messages are typically transported over different protocols.
For example,<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">
          <p id="section-1-2.1.1">EAT <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">I-D.ietf-rats-eat</a>]</span> Evidence in a "background check" topological
arrangement first flows from Attester to Relying Party, and then from Relying
Party to Verifier, over separate protocol legs.<a href="#section-1-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-2.2">
          <p id="section-1-2.2.1">Attestation Results for Secure Interactions (AR4SI) <span>[<a href="#I-D.ietf-rats-ar4si" class="cite xref">I-D.ietf-rats-ar4si</a>]</span> payloads in
"passport" mode would be sent by the Verifier to the Attester and then, at a later
point in time and over a different channel, from the Attester to the Relying Party.<a href="#section-1-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-3">It is desirable to reuse any typing information associated with the messages
across such protocol boundaries to minimize the cost associated with
type registrations and maximize interoperability. With the CMW format described
in this document, protocol designers do not need to update protocol specifications
to support different conceptual messages. This approach reduces the implementation
effort for developers to support different attestation technologies. For example,
an implementer of a Relying Party application does not need to parse
attestation-related conceptual messages, such as different Evidence formats,
but can instead utilize the CMW format to be agnostic to the attestation
technology.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document defines two encapsulation formats for RATS conceptual
messages that aim to achieve the goals stated above.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">These encapsulation formats have been specifically designed to possess the following characteristics:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
          <p id="section-1-6.1.1">They are self-describing, which means that they can convey precise typing information without relying on the framing provided by the embedding protocol or the storage system.<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.2">
          <p id="section-1-6.2.1">They are based on media types <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>, which allows the cost of their registration to be spread across numerous usage scenarios.<a href="#section-1-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-7">A protocol designer could use these formats, for example, to convey
Evidence, Endorsements and Reference Values in certificates and CRLs
extensions (<span>[<a href="#DICE-arch" class="cite xref">DICE-arch</a>]</span>), to embed Attestation Results or Evidence as
first-class authentication credentials in TLS handshake messages
<span>[<a href="#I-D.fossati-tls-attestation" class="cite xref">I-D.fossati-tls-attestation</a>]</span>, to transport attestation-related payloads in RESTful APIs,
or for stable storage of Attestation Results in the form of file system
objects.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This document also defines corresponding CBOR tag, JSON Web Tokens (JWT) and CBOR Web Tokens (CWT) claims, as well as an X.509 extension.
These allow embedding the wrapped conceptual messages into CBOR-based protocols, web APIs, and PKIX protocols.
In addition, a Media Type and a CoAP Content-Format are defined for transporting CMWs in HTTP, MIME, CoAP and other Internet protocols.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">In this document, CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> <span>[<a href="#RFC9165" class="cite xref">RFC9165</a>]</span> is used to describe the
data formats.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The reader is assumed to be familiar with the vocabulary and concepts
defined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">This document reuses the terms defined in <span><a href="https://rfc-editor.org/rfc/rfc9193#section-2" class="relref">Section 2</a> of [<a href="#RFC9193" class="cite xref">RFC9193</a>]</span>
(e.g., "Content-Type").<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conceptual-message-wrapper-encodings">
<section id="section-3">
      <h2 id="name-conceptual-message-wrapper-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conceptual-message-wrapper-" class="section-name selfRef">Conceptual Message Wrapper Encodings</a>
      </h2>
<p id="section-3-1">Two types of RATS Conceptual Message Wrapper (CMW) are specified in this
document:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-2">
<li id="section-3-2.1">
          <p id="section-3-2.1.1">A CMW using a CBOR or JSON record (<a href="#type-n-val" class="auto internal xref">Section 3.1</a>);<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.2">
          <p id="section-3-2.2.1">A CMW based on CBOR tags (<a href="#cbor-tag" class="auto internal xref">Section 3.2</a>).<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-3-3">A further CMW "collection" type that holds together multiple CMW items is defined in <a href="#cmw-coll" class="auto internal xref">Section 3.3</a>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">A CMW "tunnel" type is also defined in <a href="#cmw-tunnel" class="auto internal xref">Section 3.4</a> to allow transporting CBOR CMWs in JSON collections and vice-versa.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The collected CDDL is in <a href="#collected-cddl" class="auto internal xref">Appendix A</a>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">This document only defines an encapsulation, not a security format.
It is the responsibility of the Attester to ensure that the CMW contents have the necessary security protection.
Security considerations are discussed in <a href="#seccons" class="auto internal xref">Section 7</a>.<a href="#section-3-6" class="pilcrow">¶</a></p>
<div id="type-n-val">
<section id="section-3.1">
        <h3 id="name-cmw-record">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-cmw-record" class="section-name selfRef">CMW Record</a>
        </h3>
<p id="section-3.1-1">The format of the CMW record is shown in <a href="#fig-cddl-record" class="auto internal xref">Figure 1</a>.
The JSON <span>[<a href="#STD90" class="cite xref">STD90</a>]</span> and CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span> representations are provided separately.
Both the <code>json-record</code> and <code>cbor-record</code> have the same fields except for slight differences in the types discussed below.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">A CMW record carried in a <code>"cmw"</code> JWT claim (<a href="#iana-jwt" class="auto internal xref">Section 8.2</a>) <span class="bcp14">MUST</span> be a <code>json-record</code>.
A CMW record carried in a <code>"cmw"</code> CWT claim (<a href="#iana-cwt" class="auto internal xref">Section 8.1</a>) <span class="bcp14">MUST</span> be a <code>cbor-record</code>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span id="name-cddl-definition-of-the-reco"></span><div id="fig-cddl-record">
<figure id="figure-1">
          <div class="alignLeft art-cddl art-text artwork" id="section-3.1-3.1">
<pre>
json-record = [
  type: media-type
  value: base64url-string
  ? ind: uint .bits cm-type
]

cbor-record = [
  type: coap-content-format-type / media-type
  value: bytes
  ? ind: uint .bits cm-type
]
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-cddl-definition-of-the-reco" class="selfRef">CDDL definition of the Record format</a>
          </figcaption></figure>
</div>
<p id="section-3.1-4">Each contains two or three members:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.1-5">
          <dt id="section-3.1-5.1">
<code>type</code>:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-5.2">
            <p id="section-3.1-5.2.1">Either a text string representing a Content-Type (e.g., an EAT media type
<span>[<a href="#I-D.ietf-rats-eat-media-type" class="cite xref">I-D.ietf-rats-eat-media-type</a>]</span>) or an unsigned integer corresponding to a CoAP Content-Format
number (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-12.3" class="relref">Section 12.3</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>).
The latter <span class="bcp14">MUST NOT</span> be used in the JSON serialization.<a href="#section-3.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-5.3">
<code>value</code>:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-5.4">
            <p id="section-3.1-5.4.1">The RATS conceptual message serialized according to the
value defined in the type member.
When using JSON, the value field <span class="bcp14">MUST</span> be encoded as Base64 using the URL and
filename safe alphabet (<span><a href="https://rfc-editor.org/rfc/rfc4648#section-5" class="relref">Section 5</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>) without padding.
This always applies, even if the conceptual message format is already textual (e.g., a JWT EAT).
When using CBOR, the value field <span class="bcp14">MUST</span> be encoded as a CBOR byte string.<a href="#section-3.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-5.5">
<code>ind</code>:</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-5.6">
            <p id="section-3.1-5.6.1">An optional bitmap that indicates which conceptual message types are
carried in the <code>value</code> field.  Any combination (i.e., any value between
1 and 15, included) is allowed.  This is useful only if the <code>type</code> is
potentially ambiguous and there is no further context available to the
CMW consumer to decide.  For example, this might be the case if the base
media type is not profiled (e.g., <code>application/eat+cwt</code>), if the <code>value</code>
field contains multiple conceptual messages with different types (e.g.,
both Reference Values and Endorsements within the same <code>application/signed-corim+cbor</code>), or if the same profile identifier is
shared by different conceptual messages.
Future specifications may add new values to the <code>ind</code> field; see <a href="#iana-ind-ext" class="auto internal xref">Section 8.4</a>.<a href="#section-3.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="cbor-tag">
<section id="section-3.2">
        <h3 id="name-cmw-cbor-tags">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cmw-cbor-tags" class="section-name selfRef">CMW CBOR Tags</a>
        </h3>
<p id="section-3.2-1">CBOR Tags used as CMW may be derived from CoAP Content-Format numbers.
If a CoAP content format exists for a RATS conceptual message, the
<code>TN()</code> transform defined in <span><a href="https://rfc-editor.org/rfc/rfc9277#appendix-B" class="relref">Appendix B</a> of [<a href="#RFC9277" class="cite xref">RFC9277</a>]</span> can be used to
derive a corresponding CBOR tag in range [1668546817, 1668612095].<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The RATS conceptual message is first serialized according to the
Content-Format number associated with the CBOR tag and then encoded as a
CBOR byte string, to which the tag is prepended.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The CMW CBOR Tag is defined in <a href="#fig-cddl-cbor-tag" class="auto internal xref">Figure 2</a> as a macro with two parameters:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1"><code>tn</code>, the CBOR tag number<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.2">
            <p id="section-3.2-4.2.1"><code>$fmt</code>, the definition of the associated conceptual message<a href="#section-3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-cddl-definition-of-the-cbor"></span><div id="fig-cddl-cbor-tag">
<figure id="figure-2">
          <div class="alignLeft art-cddl art-text artwork" id="section-3.2-5.1">
<pre>
cbor-tag&lt;tn, $fmt&gt; = #6.&lt;tn&gt;(bytes .cbor $fmt)
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-cddl-definition-of-the-cbor" class="selfRef">CDDL definition of the CBOR Tag format macro</a>
          </figcaption></figure>
</div>
<p id="section-3.2-6">To add a new CMW, the <code>$cbor-tag</code> type socket is extended with a new instance of the CMW CBOR Tag macro.
For example, to associate conceptual messages of type <code>my-evidence</code> with CBOR Tag <code>1668576819</code>, one would extend <code>$cbor-tag</code> as follows:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-3.2-7">
<pre>
$cbor-tag /= cbor-tag&lt;1668576819, my-evidence&gt;

my-evidence = {
  &amp;(eat_nonce: 10) =&gt; bstr .size (8..64)
}
</pre><a href="#section-3.2-7" class="pilcrow">¶</a>
</div>
<div id="use-of-pre-existing-cbor-tags">
<section id="section-3.2.1">
          <h4 id="name-use-of-pre-existing-cbor-ta">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-use-of-pre-existing-cbor-ta" class="section-name selfRef">Use of Pre-existing CBOR Tags</a>
          </h4>
<p id="section-3.2.1-1">If a CBOR tag has been registered in association with a certain RATS
conceptual message independently of a CoAP content format (i.e., it is
not obtained by applying the <code>TN()</code> transform), it can be readily used
as an encapsulation without the extra processing described in
<a href="#cbor-tag" class="auto internal xref">Section 3.2</a>.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">A consumer can always distinguish tags that have been derived via
<code>TN()</code>, which all fall in the [1668546817, 1668612095] range, from
tags that are not, and therefore apply the right decapsulation on
receive.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cmw-coll">
<section id="section-3.3">
        <h3 id="name-cmw-collections">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-cmw-collections" class="section-name selfRef">CMW Collections</a>
        </h3>
<p id="section-3.3-1">Layered Attesters and composite devices (Sections <a href="https://rfc-editor.org/rfc/rfc9334#section-3.2" class="relref">3.2</a> and <a href="https://rfc-editor.org/rfc/rfc9334#section-3.3" class="relref">3.3</a> of <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) generate Evidence that consists of multiple parts.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">For example, in data center servers, it is not uncommon for separate attesting environments (AE) to serve a subsection of the entire machine.
One AE might measure and attest to what was booted on the main CPU, while another AE might measure and attest to what was booted on a SmartNIC plugged into a PCIe slot, and a third AE might measure and attest to what was booted on the machine's GPU.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">To address the composite Attester use case, this document defines a CMW "collection" as a container that holds several CMW items, each with a label that is unique within the scope of the collection.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">The CMW collection (<a href="#fig-cddl-collection" class="auto internal xref">Figure 3</a>) is defined as a CBOR map or JSON object with CMW values, either native or "tunnelled" (<a href="#cmw-tunnel" class="auto internal xref">Section 3.4</a>).
The position of a <code>cmw</code> entry in the <code>cmw-collection</code> is not significant.
Labels can be strings (or integers in the CBOR serialization) that serve as a mnemonic for different conceptual messages in the collection.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">The <code>"__cmwc_t"</code> key is reserved for associating an optional type to the overall collection and <span class="bcp14">MUST NOT</span> be used for a label.
The collection type is either a Uniform Resource Identifier (URI) or an object identifier (OID).
The OID is always absolute and never relative.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">Since the collection type is recursive, implementations may limit the allowed depth of nesting.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<span id="name-cddl-definition-of-the-cmw-"></span><div id="fig-cddl-collection">
<figure id="figure-3">
          <div class="alignLeft art-cddl art-text artwork" id="section-3.3-7.1">
<pre>
json-collection = {
  ? "__cmwc_t": ~uri / oid
  + &amp;(label: text) =&gt; json-CMW / c2j-tunnel
}

cbor-collection = {
  ? "__cmwc_t": ~uri / oid
  + &amp;(label: (int / text)) =&gt; cbor-CMW / j2c-tunnel
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-cddl-definition-of-the-cmw-" class="selfRef">CDDL definition of the CMW collection format</a>
          </figcaption></figure>
</div>
<p id="section-3.3-8">Although initially designed for the composite Attester use case, the CMW collection can be repurposed for other use cases requiring CMW aggregation.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">A CMW collection carried in a <code>"cmw"</code> JWT claim (<a href="#iana-jwt" class="auto internal xref">Section 8.2</a>) <span class="bcp14">MUST</span> be a <code>json-collection</code>.
A CMW collection carried in a <code>"cmw"</code> CWT claim (<a href="#iana-cwt" class="auto internal xref">Section 8.1</a>) <span class="bcp14">MUST</span> be a <code>cbor-collection</code>.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<div id="cmw-collections-role-in-composite-attester-topology">
<section id="section-3.3.1">
          <h4 id="name-cmw-collections-role-in-com">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-cmw-collections-role-in-com" class="section-name selfRef">CMW Collections' role in composite Attester topology</a>
          </h4>
<p id="section-3.3.1-1">A CMW Collection's tree structure is not required to be a spanning tree of the system's composite Attester topology.
If the labels carry semantic content for a Verifier (e.g. to improve Verifier performance or aid human comprehension), the collection <span class="bcp14">SHOULD</span> be integrity protected.
For example, the collection can be integrity protected by including it in a signed token such as a CWT or JWT.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cmw-tunnel">
<section id="section-3.4">
        <h3 id="name-cmw-tunnel">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-cmw-tunnel" class="section-name selfRef">CMW Tunnel</a>
        </h3>
<p id="section-3.4-1">The CMW tunnel type (<a href="#fig-cddl-tunnel" class="auto internal xref">Figure 4</a>) allows for moving a CMW in one serialization format, either JSON or CBOR, into a collection that uses the opposite serialization format.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Both tunnel types are arrays with two elements.
The first element, a fixed text string starting with a <code>#</code>, acts as a sentinel value.
The <code>#</code>, which is not an acceptable start symbol for the <code>Content-Type</code> production (<a href="#collected-cddl" class="auto internal xref">Appendix A</a>), makes it possible to disambiguate a CMW tunnel from a CMW record.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<span id="name-cddl-definition-of-the-cmw-t"></span><div id="fig-cddl-tunnel">
<figure id="figure-4">
          <div class="alignLeft art-cddl art-text artwork" id="section-3.4-3.1">
<pre>
c2j-tunnel = [ "#cmw-c2j-tunnel", base64url-string ]
j2c-tunnel = [ "#cmw-j2c-tunnel", bytes ]
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-cddl-definition-of-the-cmw-t" class="selfRef">CDDL definition of the CMW tunnel format</a>
          </figcaption></figure>
</div>
<p id="section-3.4-4">The conversion algorithms are described in the following subsections.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<div id="cbor-to-json">
<section id="section-3.4.1">
          <h4 id="name-cbor-to-json">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-cbor-to-json" class="section-name selfRef">CBOR-to-JSON</a>
          </h4>
<p id="section-3.4.1-1">The CBOR byte string of the serialised CBOR CMW is encoded as Base64 using the URL and filename safe alphabet (<span><a href="https://rfc-editor.org/rfc/rfc4648#section-5" class="relref">Section 5</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>) without padding.
The obtained string is added as the second element of the <code>c2j-tunnel</code> array.
The <code>c2j-tunnel</code> array is serialized as JSON.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="json-to-cbor">
<section id="section-3.4.2">
          <h4 id="name-json-to-cbor">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-json-to-cbor" class="section-name selfRef">JSON-to-CBOR</a>
          </h4>
<p id="section-3.4.2-1">The UTF-8 string of the serialized JSON CMW is encoded as a CBOR byte string (Major type 2).
The byte string is added as the second element of the <code>j2c-tunnel</code> array.
The <code>j2c-tunnel</code> array is serialized as CBOR.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="decapsulation-algorithm">
<section id="section-3.5">
        <h3 id="name-decapsulation-algorithm">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-decapsulation-algorithm" class="section-name selfRef">Decapsulation Algorithm</a>
        </h3>
<p id="section-3.5-1">Once any external framing is removed (for example, if the CMW is carried in a certificate extension), the CMW decoder performs a 1-byte lookahead to determine how to decode the remaining byte buffer.
The following pseudo-code illustrates this process:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-2">
<pre>
func CMWTypeSniff(b []byte) (CMW, error) {
  if len(b) == 0 {
    return Unknown
  }

  if b[0] == 0x82 || b[0] == 0x83 {
    return CBORRecord
  } else if b[0] &gt;= 0xc0 &amp;&amp; b[0] &lt;= 0xdb {
    return CBORTag
  } else if b[0] == 0x5b {
    return JSONRecord
  } else if b[0] == 0x7b {
    return JSONCollection
  } else if (b[0] &gt;= 0xa0 &amp;&amp; b[0] &lt;= 0xbb) || b[0] == 0xbf {
    return CBORCollection
  }

  return Unknown
}
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-4">
      <h2 id="name-examples">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-4-1">The (equivalent) examples in <a href="#ex-ja" class="auto internal xref">Section 4.1</a>, <a href="#ex-ca" class="auto internal xref">Section 4.2</a>, and <a href="#ex-ct" class="auto internal xref">Section 4.3</a> assume that
the Media-Type-Name <code>application/vnd.example.rats-conceptual-msg</code> has been
registered alongside a corresponding CoAP Content-Format number <code>30001</code>.  The
CBOR tag <code>1668576818</code> is derived applying the <code>TN()</code> transform as described in
<a href="#cbor-tag" class="auto internal xref">Section 3.2</a>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The example in <a href="#ex-ca-ind" class="auto internal xref">Section 4.4</a> is a signed CoRIM (Concise Reference Integrity Manifest) <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span> payload with an explicit CM
indicator <code>0b0000_0011</code> (3), meaning that the wrapped message contains both
Reference Values and Endorsements.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="ex-ja">
<section id="section-4.1">
        <h3 id="name-json-record">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-json-record" class="section-name selfRef">JSON Record</a>
        </h3>
<div class="lang-cbor-diag sourcecode" id="section-4.1-1">
<pre>
[
  "application/vnd.example.rats-conceptual-msg",
  "q82rzQ"
]
</pre><a href="#section-4.1-1" class="pilcrow">¶</a>
</div>
<p id="section-4.1-2">Note that a CoAP Content-Format number can also be used with the JSON record
form.  That may be the case when it is known that the receiver can handle CoAP
Content-Formats and it is crucial to save bytes.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ex-ca">
<section id="section-4.2">
        <h3 id="name-cbor-record">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-cbor-record" class="section-name selfRef">CBOR Record</a>
        </h3>
<div class="lang-cbor-diag sourcecode" id="section-4.2-1">
<pre>
[
  30001,
  h'2347da55'
]
</pre><a href="#section-4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2-2">with the following wire representation:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-3">
<pre>
82             # array(2)
   19 7531     # unsigned(30001)
   44          # bytes(4)
      2347da55 # "#G\xDAU"
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2-4">Note that a Media-Type-Name can also be used with the CBOR record form,
for example if it is known that the receiver cannot handle CoAP
Content-Formats, or (unlike the case in point) if a CoAP Content-Format
number has not been registrered.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-4.2-5">
<pre>
[
  "application/vnd.example.rats-conceptual-msg",
  h'2347da55'
]
</pre><a href="#section-4.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ex-ct">
<section id="section-4.3">
        <h3 id="name-cbor-tag">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-cbor-tag" class="section-name selfRef">CBOR Tag</a>
        </h3>
<div class="lang-cbor-diag sourcecode" id="section-4.3-1">
<pre>
1668576818(h'2347da55')
</pre><a href="#section-4.3-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3-2">with the following wire representation:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-3">
<pre>
da 63747632    # tag(1668576818)
   44          # bytes(4)
      2347da55 # "#G\xDAU"
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ex-ca-ind">
<section id="section-4.4">
        <h3 id="name-cbor-record-with-explicit-c">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-cbor-record-with-explicit-c" class="section-name selfRef">CBOR Record with explicit CM indicator</a>
        </h3>
<div class="lang-cbor-diag sourcecode" id="section-4.4-1">
<pre>
[
  "application/signed-corim+cbor",
  h'd28443a10126a1',
  3
]
</pre><a href="#section-4.4-1" class="pilcrow">¶</a>
</div>
<p id="section-4.4-2">with the following wire representation:<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-3">
<pre>
83                                    # array(3)
   78 1d                              # text(29)
      6170706c69636174696f6e2f7369676e65642d636f72696d2b63626f72
                                      # "application/signed-corim+cbor"
   47                                 # bytes(7)
      d28443a10126a1                  # "҄C\xA1\u0001&amp;\xA1"
   03                                 # unsigned(3)
</pre><a href="#section-4.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor-collection">
<section id="section-4.5">
        <h3 id="name-cbor-collection">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-cbor-collection" class="section-name selfRef">CBOR Collection</a>
        </h3>
<p id="section-4.5-1">The following example is a CBOR collection that assembles conceptual messages from three attesters: Evidence for attesters A and B and Attestation Results for attester C.
It is given an explicit collection type using the URI form.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-2">
<pre>
{
  "attester A": [
    30001,
    h'2347da55',
    4
  ],
  "attester B": 1668576818(h'2347da55'),
  "attester C": [
    "application/eat+jwt",
    h'4c693475',
    8
  ]
}
</pre><a href="#section-4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5-3">with the following wire representation:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-4">
<pre>
a3                                      # map(3)
   6a                                   # text(10)
      61747465737465722041              # "attester A"
   83                                   # array(3)
      19 7531                           # unsigned(30001)
      44                                # bytes(4)
         2347da55                       # "#G\xDAU"
      04                                # unsigned(4)
   6a                                   # text(10)
      61747465737465722042              # "attester B"
   da 63747632                          # tag(1668576818)
      44                                # bytes(4)
         2347da55                       # "#G\xDAU"
   6a                                   # text(10)
      61747465737465722043              # "attester C"
   83                                   # array(3)
      73                                # text(19)
         6170706c69636174696f6e2f6561742b6a7774 # "application/eat+jwt"
      44                                # bytes(4)
         4c693475                       # "Li4u"
      08                                # unsigned(8)
</pre><a href="#section-4.5-4" class="pilcrow">¶</a>
</div>
<p id="section-4.5-5">The following example shows the use of a tunnelled type to move a JSON record to a CBOR collection:<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-6">
<pre>
{
  "__cmwc_t": "tag:example.com,2024:composite-attester",
  0: [
    30001,
    h'2347da55',
    4
  ],
  1: 1668576818(h'2347da55'),
  2: [
    "#cmw-j2c-tunnel",
    '[ "application/eat+jwt", "Li4u", 8 ]'
  ]
}
</pre><a href="#section-4.5-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="json-collection">
<section id="section-4.6">
        <h3 id="name-json-collection">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-json-collection" class="section-name selfRef">JSON Collection</a>
        </h3>
<p id="section-4.6-1">The following example is a JSON collection that assembles Evidence from two attesters.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-2">
<pre>
{
  "attester A": [
    "application/eat-ucs+json",
    "e30K",
    4
  ],
  "attester B": [
    "application/eat-ucs+cbor",
    "oA",
    4
  ]
}
</pre><a href="#section-4.6-2" class="pilcrow">¶</a>
</div>
<p id="section-4.6-3">The following example shows the use of a tunnelled type to move a CBOR record to a JSON collection:<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6-4">
<pre>
{
  "attester A": [
    "application/eat-ucs+json",
    "e30K",
    4
  ],
  "attester B (tunnelled)": [
    "#cmw-c2j-tunnel",
    "g3gYYXBwbGljYXRpb24vZWF0LXVjcytjYm9yQaAE"
  ]
}
</pre><a href="#section-4.6-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="use-in-jwt">
<section id="section-4.7">
        <h3 id="name-use-in-jwt">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-use-in-jwt" class="section-name selfRef">Use in JWT</a>
        </h3>
<p id="section-4.7-1">The following example shows the use of the <code>"cmw"</code> JWT claim to transport a CMW collection in a JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>:<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7-2">
<pre>
{
  "cmw": {
    "attester A": [
      "application/eat-ucs+json",
      "e30K",
      4
    ],
    "attester B (tunnelled)": [
      "#cmw-c2j-tunnel",
      "g3gYYXBwbGljYXRpb24vZWF0LXVjcytjYm9yQaAE"
    ]
  },
  "iss": "evidence collection daemon",
  "exp": 1300819380
}
</pre><a href="#section-4.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="x509">
<section id="section-5">
      <h2 id="name-transporting-cmw-in-x509-me">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-transporting-cmw-in-x509-me" class="section-name selfRef">Transporting CMW in X.509 Messages</a>
      </h2>
<p id="section-5-1">CMW may need to be transported in PKIX messages, such as Certificate Signing Requests (CSRs) or in X.509 Certificates and Certificate Revocation Lists (CRLs).
The former use is documented in <span>[<a href="#I-D.ietf-lamps-csr-attestation" class="cite xref">I-D.ietf-lamps-csr-attestation</a>]</span>, the latter in Section 6.1 of <span>[<a href="#DICE-arch" class="cite xref">DICE-arch</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This section specifies the CMW extension to carry CMW objects.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The CMW extension <span class="bcp14">MAY</span> be included in X.509 Certificates, CRLs <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and CSRs.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The CMW extension <span class="bcp14">MUST</span> be identified by the following object identifier:<a href="#section-5-4" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-5">
<pre>
id-pe-cmw  OBJECT IDENTIFIER ::=
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-pe(1) TBD }
</pre><a href="#section-5-5" class="pilcrow">¶</a>
</div>
<p id="section-5-6">This extension <span class="bcp14">SHOULD NOT</span> be marked critical.
It <span class="bcp14">MAY</span> be marked critical in cases where the attestation-related information is essential for granting resource access, and there is a risk that legacy relying parties would bypass such controls.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">The CMW extension <span class="bcp14">MUST</span> have the following syntax:<a href="#section-5-7" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-8">
<pre>
CMW ::= CHOICE {
    json UTF8String,
    cbor OCTET STRING
}
</pre><a href="#section-5-8" class="pilcrow">¶</a>
</div>
<p id="section-5-9">The CMW <span class="bcp14">MUST</span> contain the serialized CMW object in JSON or CBOR format, using the appropriate CHOICE entry.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10">The DER-encoded CMW is the value of the OCTET STRING for the extnValue field of the extension.<a href="#section-5-10" class="pilcrow">¶</a></p>
<div id="asn1-x509">
<section id="section-5.1">
        <h3 id="name-asn1-module">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
        </h3>
<p id="section-5.1-1">This section provides an ASN.1 module <span>[<a href="#X.680" class="cite xref">X.680</a>]</span> for the CMW extension, following the conventions established in <span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span> and <span>[<a href="#RFC6268" class="cite xref">RFC6268</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1-2">
<pre>
CMWExtn
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-cmw-collection-extn(TBD) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
  EXTENSION
  FROM PKIX-CommonTypes-2009  -- RFC 5912
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkixCommon-02(57) } ;

-- CMW Extension

ext-CMW EXTENSION ::= {
  SYNTAX CMW
  IDENTIFIED BY id-pe-cmw }

-- CMW Extension OID

id-pe-cmw  OBJECT IDENTIFIER  ::=
   { iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) id-pe(1) TBD }

-- CMW Extension Syntax

CMW ::= CHOICE {
    json UTF8String,
    cbor OCTET STRING
}

END
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="compatibility-with-dice-conceptualmessagewrapper">
<section id="section-5.2">
        <h3 id="name-compatibility-with-dice-con">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-compatibility-with-dice-con" class="section-name selfRef">Compatibility with DICE <code>ConceptualMessageWrapper</code></a>
        </h3>
<p id="section-5.2-1">Section 6.1.8 of <span>[<a href="#DICE-arch" class="cite xref">DICE-arch</a>]</span> defines the ConceptualMessageWrapper format and the associated object identifier.
The CMW format defined in <span>[<a href="#DICE-arch" class="cite xref">DICE-arch</a>]</span> allows only a subset of the CMW grammar defined in this document.
Specifically, the tunnel and collection formats cannot be encoded using DICE CMWs.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-6">
      <h2 id="name-implementation-status">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-6-1">This section records the status of known implementations of the protocol
defined by this specification at the time of posting of this Internet-Draft,
and is based on a proposal described in <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>.
The description of implementations in this section is intended to assist the
IETF in its decision processes in progressing drafts to RFCs.
Please note that the listing of any individual implementation here does not
imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information presented here
that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a catalog of
available implementations or their features.
Readers are advised to note that other implementations may exist.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">According to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>, "this will allow reviewers and working groups to
assign due consideration to documents that have the benefit of running code,
which may serve as evidence of valuable experimentation and feedback that have
made the implemented protocols more mature.
It is up to the individual working groups to use this information as they see
fit".<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="project-veraison">
<section id="section-6.1">
        <h3 id="name-project-veraison">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-project-veraison" class="section-name selfRef">Project Veraison</a>
        </h3>
<p id="section-6.1-1">The organization responsible for this implementation is Project Veraison, a
Linux Foundation project hosted at the Confidential Computing Consortium.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The software, hosted at <span><a href="https://github.com/veraison/cmw">https://github.com/veraison/cmw</a></span>, provides a Golang
package that allows encoding and decoding of CMW payloads.
The implementation covers all the features presented in this draft.
The maturity level is alpha.
The license is Apache 2.0.
The developers can be contacted on the Zulip channel:
<span><a href="https://veraison.zulipchat.com/#narrow/stream/383526-CMW/">https://veraison.zulipchat.com/#narrow/stream/383526-CMW/</a></span>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="seccons">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This document introduces two encapsulation formats for RATS conceptual messages, record and tag.
RATS conceptual messages are typically secured using cryptography.
If the messages are already protected, then there are no additional security requirements imposed by the introduction of this encapsulation.
If an adversary tries to modify the payload encapsulation, it will result in incorrect processing of the encapsulated message and lead to an error.
If the messages are not protected, additional security must be added at a different layer.
As an example, a <code>cbor-record</code> containing an UCCS (Unprotected CWT Claims Sets) <span>[<a href="#I-D.ietf-rats-uccs" class="cite xref">I-D.ietf-rats-uccs</a>]</span> can be signed using COSE Sign1 <span>[<a href="#STD96" class="cite xref">STD96</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">This document introduces a format for holding multiple CMW items in a collection.
If the collection is not protected from tampering by external security measures (such as object security primitives) or internal mechanisms (such as intra-item binding), an attacker could easily manipulate the collection's contents.
It is the responsibility of the Attester who creates the CMW collection to ensure that the contents of the collection are integrity-protected.
The designer of the attestation technology is typically in charge of ensuring that the security properties are met, not the user of the conceptual message wrapper.
In particular, when a CMW is used to carry multiple Evidence messages for a composite device or layered attestation, there should be strong binding between the Evidence messages within the collection.
This binding is needed to prevent attacks where Evidence from a subverted part of the device is replaced by Evidence from a separate non-subverted device.
The binding of Evidence messages should be some form of attestation.
For example, key material used to sign/bind an entire CMW collection should be attestation key material handled as described in <span><a href="https://rfc-editor.org/rfc/rfc9334#section-12.1" class="relref">Section 12.1</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.
The binding does not necessarily have to be a signature over the CMW collection, it might also be achieved through identifiers, cross-linking, signing or hashing between the members of the collection.
Client-authenticated TLS may be used to bind a CMW collection of Evidence messages.
However, the client key used with TLS should not be that of the end-user or owner of the device.
Instead, it should be attestation-oriented key material from the device or the attester manufacturer.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1"><span class="cref" id="rfced">RFC Editor:</span> replace "RFCthis" with the RFC number assigned to this document.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="iana-cwt">
<section id="section-8.1">
        <h3 id="name-cwt-cmw-claim-registration">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cwt-cmw-claim-registration" class="section-name selfRef">CWT <code>cmw</code> Claim Registration</a>
        </h3>
<p id="section-8.1-1">IANA is requested to add a new <code>cmw</code> claim to the "CBOR Web Token (CWT) Claims" registry <span>[<a href="#IANA.cwt" class="cite xref">IANA.cwt</a>]</span> as follows:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1">Claim Name: cmw<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.2">
            <p id="section-8.1-2.2.1">Claim Description: A RATS Conceptual Message Wrapper<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.3">
            <p id="section-8.1-2.3.1">Claim Key: TBD<a href="#section-8.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.4">
            <p id="section-8.1-2.4.1">Claim Value Type(s): CBOR Map, CBOR Array, or CBOR Tag<a href="#section-8.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.5">
            <p id="section-8.1-2.5.1">Change Controller: IETF<a href="#section-8.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.6">
            <p id="section-8.1-2.6.1">Specification Document(s): <a href="#type-n-val" class="auto internal xref">Section 3.1</a>, <a href="#cmw-coll" class="auto internal xref">Section 3.3</a> and <a href="#cbor-tag" class="auto internal xref">Section 3.2</a> of RFCthis<a href="#section-8.1-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-3">The suggested value for the Claim Key is 299.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-jwt">
<section id="section-8.2">
        <h3 id="name-jwt-cmw-claim-registration">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-jwt-cmw-claim-registration" class="section-name selfRef">JWT <code>cmw</code> Claim Registration</a>
        </h3>
<p id="section-8.2-1">IANA is requested to add a new <code>cmw</code> claim to the "JSON Web Token Claims" sub-registry of the "JSON Web Token (JWT)" registry <span>[<a href="#IANA.jwt" class="cite xref">IANA.jwt</a>]</span> as follows:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.1">
            <p id="section-8.2-2.1.1">Claim Name: cmw<a href="#section-8.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-2.2">
            <p id="section-8.2-2.2.1">Claim Description: A RATS Conceptual Message Wrapper<a href="#section-8.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-2.3">
            <p id="section-8.2-2.3.1">Change Controller: IETF<a href="#section-8.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-2.4">
            <p id="section-8.2-2.4.1">Specification Document(s): <a href="#type-n-val" class="auto internal xref">Section 3.1</a> and <a href="#cmw-coll" class="auto internal xref">Section 3.3</a> of RFCthis<a href="#section-8.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="cbor-tag-registration">
<section id="section-8.3">
        <h3 id="name-cbor-tag-registration">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-cbor-tag-registration" class="section-name selfRef">CBOR Tag Registration</a>
        </h3>
<p id="section-8.3-1">IANA is requested to add the following tag to the "CBOR Tags" <span>[<a href="#IANA.cbor-tags" class="cite xref">IANA.cbor-tags</a>]</span> registry.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">CBOR Tag</th>
              <th class="text-left" rowspan="1" colspan="1">Data Item</th>
              <th class="text-left" rowspan="1" colspan="1">Semantics</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">CBOR map, CBOR array, CBOR tag</td>
              <td class="text-left" rowspan="1" colspan="1">RATS Conceptual Message Wrapper</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#type-n-val" class="auto internal xref">Section 3.1</a>, <a href="#cbor-tag" class="auto internal xref">Section 3.2</a> and <a href="#cmw-coll" class="auto internal xref">Section 3.3</a> of RFCthis</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-ind-ext">
<section id="section-8.4">
        <h3 id="name-rats-conceptual-message-wra">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-rats-conceptual-message-wra" class="section-name selfRef">RATS Conceptual Message Wrapper (CMW) Indicators Registry</a>
        </h3>
<p id="section-8.4-1">This specification defines a new "RATS Conceptual Message Wrapper (CMW) Indicators" registry, with the policy "Expert Review" (<span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#BCP26" class="cite xref">BCP26</a>]</span>).<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">The objective is to have CMW Indicators values registered for all RATS Conceptual Messages (<span><a href="https://rfc-editor.org/rfc/rfc9334#section-8" class="relref">Section 8</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>).<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<div id="de-instructions">
<section id="section-8.4.1">
          <h4 id="name-instructions-for-the-design">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-instructions-for-the-design" class="section-name selfRef">Instructions for the Designated Expert</a>
          </h4>
<p id="section-8.4.1-1">The expert is instructed to add the values incrementally.<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<p id="section-8.4.1-2">Acceptable values are those corresponding to RATS Conceptual Messages defined by the RATS architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and any of its updates.<a href="#section-8.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="structure-of-entries">
<section id="section-8.4.2">
          <h4 id="name-structure-of-entries">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-structure-of-entries" class="section-name selfRef">Structure of Entries</a>
          </h4>
<p id="section-8.4.2-1">Each entry in the registry must include:<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-8.4.2-2">
            <dt id="section-8.4.2-2.1">Indicator value:</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-2.2">
              <p id="section-8.4.2-2.2.1">A number corresponding to the bit position in the <code>ind</code> bitmap (<a href="#type-n-val" class="auto internal xref">Section 3.1</a>).<a href="#section-8.4.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.4.2-2.3">Conceptual Message name:</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-2.4">
              <p id="section-8.4.2-2.4.1">A text string describing the RATS conceptual message this indicator corresponds to.<a href="#section-8.4.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.4.2-2.5">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-8.4.2-2.6">
              <p id="section-8.4.2-2.6.1">A reference to a document, if available, or the registrant.<a href="#section-8.4.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-8.4.2-3">The initial registrations for the registry are detailed in <a href="#tab-ind-regs" class="auto internal xref">Table 2</a>.<a href="#section-8.4.2-3" class="pilcrow">¶</a></p>
<span id="name-cmw-indicators-registry-ini"></span><div id="tab-ind-regs">
<table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-cmw-indicators-registry-ini" class="selfRef">CMW Indicators Registry Initial Contents</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Indicator value</th>
                <th class="text-left" rowspan="1" colspan="1">Conceptual Message name</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Reference Values</td>
                <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">Endorsements</td>
                <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">Evidence</td>
                <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">Attestation Results</td>
                <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4-31</td>
                <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="provisional-registration">
<section id="section-8.4.3">
          <h4 id="name-provisional-registration">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-provisional-registration" class="section-name selfRef">Provisional Registration</a>
          </h4>
<p id="section-8.4.3-1">Before the creation of the registry by IANA, new codepoints can be added to the <a href="https://github.com/ietf-rats-wg/draft-ietf-rats-msg-wrap/blob/main/provisional/cmw-indicators-registry.md">provisional CMW Indicators registry</a> by following the documented procedure.<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<p id="section-8.4.3-2"><a href="#tab-ind-regs" class="auto internal xref">Table 2</a> will be regularly updated to match the contents of the provisional registry.<a href="#section-8.4.3-2" class="pilcrow">¶</a></p>
<p id="section-8.4.3-3">The provisional registry will be discontinued once IANA establishes the permanent registry, which is expected to coincide with the publication of the current document.<a href="#section-8.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="media-types">
<section id="section-8.5">
        <h3 id="name-media-types">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-media-types" class="section-name selfRef">Media Types</a>
        </h3>
<p id="section-8.5-1">IANA is requested to add the following media types to the "Media Types" registry <span>[<a href="#IANA.media-types" class="cite xref">IANA.media-types</a>]</span>.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<span id="name-cmw-media-types"></span><div id="tab-mt-regs">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-cmw-media-types" class="selfRef">CMW Media Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Template</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>cmw+cbor</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>application/cmw+cbor</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#type-n-val" class="auto internal xref">Section 3.1</a>, <a href="#cbor-tag" class="auto internal xref">Section 3.2</a> and <a href="#cmw-coll" class="auto internal xref">Section 3.3</a> of RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>cmw+json</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>application/cmw+json</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#type-n-val" class="auto internal xref">Section 3.1</a> and <a href="#cmw-coll" class="auto internal xref">Section 3.3</a> of RFCthis</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="applicationcmwcbor">
<section id="section-8.5.1">
          <h4 id="name-application-cmwcbor">
<a href="#section-8.5.1" class="section-number selfRef">8.5.1. </a><a href="#name-application-cmwcbor" class="section-name selfRef"><code>application/cmw+cbor</code></a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-8.5.1-1">
            <dt id="section-8.5.1-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.2">
              <p id="section-8.5.1-1.2.1">application<a href="#section-8.5.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.4">
              <p id="section-8.5.1-1.4.1">cmw+cbor<a href="#section-8.5.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.6">
              <p id="section-8.5.1-1.6.1">n/a<a href="#section-8.5.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.8">
              <p id="section-8.5.1-1.8.1"><code>cmwc_t</code> (CMW collection type in string format.  The parameter value is case-insensitive.  It <span class="bcp14">MUST NOT</span> be used for CMW that are not collections.)<a href="#section-8.5.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.10">
              <p id="section-8.5.1-1.10.1">binary (CBOR)<a href="#section-8.5.1-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.12">
              <p id="section-8.5.1-1.12.1"><a href="#seccons" class="auto internal xref">Section 7</a> of RFCthis<a href="#section-8.5.1-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.14">
              <p id="section-8.5.1-1.14.1">n/a<a href="#section-8.5.1-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.16">
              <p id="section-8.5.1-1.16.1">RFCthis<a href="#section-8.5.1-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.18">
              <p id="section-8.5.1-1.18.1">Attesters, Verifiers, Endorsers and Reference-Value providers, Relying Parties that need to transfer CMW payloads over HTTP(S), CoAP(S), and other transports.<a href="#section-8.5.1-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.20">
              <p id="section-8.5.1-1.20.1">The syntax and semantics of fragment identifiers are as specified for "application/cbor". (No fragment identification syntax is currently defined for "application/cbor".)<a href="#section-8.5.1-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.21">Person &amp; email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.22">
              <p id="section-8.5.1-1.22.1">RATS WG mailing list (rats@ietf.org)<a href="#section-8.5.1-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.23">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.24">
              <p id="section-8.5.1-1.24.1">COMMON<a href="#section-8.5.1-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.25">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.26">
              <p id="section-8.5.1-1.26.1">none<a href="#section-8.5.1-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.27">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.28">
              <p id="section-8.5.1-1.28.1">IETF<a href="#section-8.5.1-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.29">Provisional registration:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.1-1.30">
              <p id="section-8.5.1-1.30.1">no<a href="#section-8.5.1-1.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="applicationcmwjson">
<section id="section-8.5.2">
          <h4 id="name-application-cmwjson">
<a href="#section-8.5.2" class="section-number selfRef">8.5.2. </a><a href="#name-application-cmwjson" class="section-name selfRef"><code>application/cmw+json</code></a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-8.5.2-1">
            <dt id="section-8.5.2-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.2">
              <p id="section-8.5.2-1.2.1">application<a href="#section-8.5.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.4">
              <p id="section-8.5.2-1.4.1">cmw+json<a href="#section-8.5.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.6">
              <p id="section-8.5.2-1.6.1">n/a<a href="#section-8.5.2-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.8">
              <p id="section-8.5.2-1.8.1"><code>cmwc_t</code> (CMW collection type in string format.  The parameter value is case-insensitive.  It <span class="bcp14">MUST NOT</span> be used for CMW that are not collections.)<a href="#section-8.5.2-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.10">
              <p id="section-8.5.2-1.10.1">binary (JSON is UTF-8-encoded text)<a href="#section-8.5.2-1.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.12">
              <p id="section-8.5.2-1.12.1"><a href="#seccons" class="auto internal xref">Section 7</a> of RFCthis<a href="#section-8.5.2-1.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.14">
              <p id="section-8.5.2-1.14.1">n/a<a href="#section-8.5.2-1.14.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.16">
              <p id="section-8.5.2-1.16.1">RFCthis<a href="#section-8.5.2-1.16.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.18">
              <p id="section-8.5.2-1.18.1">Attesters, Verifiers, Endorsers and Reference-Value providers, Relying Parties that need to transfer CMW payloads over HTTP(S), CoAP(S), and other transports.<a href="#section-8.5.2-1.18.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.20">
              <p id="section-8.5.2-1.20.1">The syntax and semantics of fragment identifiers are as specified for "application/json". (No fragment identification syntax is currently defined for "application/json".)<a href="#section-8.5.2-1.20.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.21">Person &amp; email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.22">
              <p id="section-8.5.2-1.22.1">RATS WG mailing list (rats@ietf.org)<a href="#section-8.5.2-1.22.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.23">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.24">
              <p id="section-8.5.2-1.24.1">COMMON<a href="#section-8.5.2-1.24.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.25">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.26">
              <p id="section-8.5.2-1.26.1">none<a href="#section-8.5.2-1.26.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.27">Author/Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.28">
              <p id="section-8.5.2-1.28.1">IETF<a href="#section-8.5.2-1.28.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.2-1.29">Provisional registration:</dt>
            <dd style="margin-left: 1.5em" id="section-8.5.2-1.30">
              <p id="section-8.5.2-1.30.1">no<a href="#section-8.5.2-1.30.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="coap-content-formats">
<section id="section-8.6">
        <h3 id="name-coap-content-formats">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-coap-content-formats" class="section-name selfRef">CoAP Content Formats</a>
        </h3>
<p id="section-8.6-1">IANA is requested to register the following Content-Format numbers in the "CoAP Content-Formats" sub-registry, within the "Constrained RESTful Environments (CoRE) Parameters" Registry <span>[<a href="#IANA.core-parameters" class="cite xref">IANA.core-parameters</a>]</span>:<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<span id="name-new-coap-content-formats"></span><table class="left" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-new-coap-content-formats" class="selfRef">New CoAP Content Formats</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Content-Type</th>
              <th class="text-left" rowspan="1" colspan="1">Content Coding</th>
              <th class="text-left" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/cmw+cbor</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#type-n-val" class="auto internal xref">Section 3.1</a>, <a href="#cbor-tag" class="auto internal xref">Section 3.2</a> and <a href="#cmw-coll" class="auto internal xref">Section 3.3</a> of RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/cmw+json</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD2</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#type-n-val" class="auto internal xref">Section 3.1</a> and <a href="#cmw-coll" class="auto internal xref">Section 3.3</a> of RFCthis</td>
            </tr>
          </tbody>
        </table>
<p id="section-8.6-3">If possible, TBD1 and TBD2 should be assigned in the 256..999 range.<a href="#section-8.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-smi-numbers-registrations">
<section id="section-8.7">
        <h3 id="name-new-smi-numbers-registratio">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-new-smi-numbers-registratio" class="section-name selfRef">New SMI Numbers Registrations</a>
        </h3>
<p id="section-8.7-1">IANA is requested to assign an object identifier (OID) for the CMW extension defined in <a href="#x509" class="auto internal xref">Section 5</a> in the "Certificate Extension" sub-registry of the "SMI Numbers" <span>[<a href="#IANA.smi-numbers" class="cite xref">IANA.smi-numbers</a>]</span> registry.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2">IANA is requested to assign an object identifier (OID) for the ASN.1 Module defined in <a href="#asn1-x509" class="auto internal xref">Section 5.1</a> in the "Module Identifier" sub-registry of the "SMI Numbers" <span>[<a href="#IANA.smi-numbers" class="cite xref">IANA.smi-numbers</a>]</span> registry.<a href="#section-8.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP26">[BCP26]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cbor-tags">[IANA.cbor-tags]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Tags"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cbor-tags">https://www.iana.org/assignments/cbor-tags</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.core-parameters">[IANA.core-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cwt">[IANA.cwt]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CBOR Web Token (CWT) Claims"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cwt">https://www.iana.org/assignments/cwt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.jwt">[IANA.jwt]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/jwt">https://www.iana.org/assignments/jwt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.media-types">[IANA.media-types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Media Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/media-types">https://www.iana.org/assignments/media-types</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.smi-numbers">[IANA.smi-numbers]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Structure of Management Information (SMI) Numbers (MIB Module Registrations)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/smi-numbers">https://www.iana.org/assignments/smi-numbers</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5912">https://www.rfc-editor.org/rfc/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6268">[RFC6268]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 6268</span>, <span class="seriesInfo">DOI 10.17487/RFC6268</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6268">https://www.rfc-editor.org/rfc/rfc6268</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9165">[RFC9165]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Additional Control Operators for the Concise Data Definition Language (CDDL)"</span>, <span class="seriesInfo">RFC 9165</span>, <span class="seriesInfo">DOI 10.17487/RFC9165</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9165">https://www.rfc-editor.org/rfc/rfc9165</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9277">[RFC9277]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"On Stable Storage for Items in Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 9277</span>, <span class="seriesInfo">DOI 10.17487/RFC9277</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9277">https://www.rfc-editor.org/rfc/rfc9277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD90">[STD90]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD94">[STD94]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
      <dd>
<span class="refAuthor">International Telephone and Telegraph Consultative Committee</span>, <span class="refTitle">"Specification of Abstract Syntax Notation One (ASN.1): Specification of Basic Notation"</span>, <span class="seriesInfo">CCITT Recommendation X.680</span>, <time datetime="1994-07" class="refDate">July 1994</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DICE-arch">[DICE-arch]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"DICE Attestation Architecture"</span>, <time datetime="2024-01" class="refDate">January 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/DICE-Attestation-Architecture-Version-1.1-Revision-18_pub.pdf">https://trustedcomputinggroup.org/wp-content/uploads/DICE-Attestation-Architecture-Version-1.1-Revision-18_pub.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fossati-tls-attestation">[I-D.fossati-tls-attestation]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Howard, P.</span>, <span class="refAuthor">Mihalcea, I.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Niemi, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fossati-tls-attestation-07</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-07">https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-csr-attestation">[I-D.ietf-lamps-csr-attestation]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Wiseman, M.</span>, and <span class="refAuthor">N. Smith</span>, <span class="refTitle">"Use of Remote Attestation with Certification Signing Requests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-csr-attestation-10</span>, <time datetime="2024-07-07" class="refDate">7 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-10">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-ar4si">[I-D.ietf-rats-ar4si]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Hardjono, T.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">V. Scarlata</span>, <span class="refTitle">"Attestation Results for Secure Interactions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-ar4si-07</span>, <time datetime="2024-09-02" class="refDate">2 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-07">https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-corim">[I-D.ietf-rats-corim]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Concise Reference Integrity Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-corim-05</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-05">https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat">[I-D.ietf-rats-eat]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-30</span>, <time datetime="2024-08-02" class="refDate">2 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-30">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-30</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat-media-type">[I-D.ietf-rats-eat-media-type]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"EAT Media Types"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-media-type-09</span>, <time datetime="2024-08-21" class="refDate">21 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-media-type-09">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-media-type-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-uccs">[I-D.ietf-rats-uccs]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">O'Donoghue, J.</span>, <span class="refAuthor">Cam-Winget, N.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"A CBOR Tag for Unprotected CWT Claims Sets"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-uccs-10</span>, <time datetime="2024-07-04" class="refDate">4 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-uccs-10">https://datatracker.ietf.org/doc/html/draft-ietf-rats-uccs-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9193">[RFC9193]</dt>
        <dd>
<span class="refAuthor">Keränen, A.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Sensor Measurement Lists (SenML) Fields for Indicating Data Value Content-Format"</span>, <span class="seriesInfo">RFC 9193</span>, <span class="seriesInfo">DOI 10.17487/RFC9193</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9193">https://www.rfc-editor.org/rfc/rfc9193</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD96">[STD96]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="collected-cddl">
<section id="appendix-A">
      <h2 id="name-collected-cddl">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-collected-cddl" class="section-name selfRef">Collected CDDL</a>
      </h2>
<div class="breakable lang-cddl sourcecode" id="appendix-A-1">
<pre>
start = cmw

cmw = json-CMW / cbor-CMW

json-CMW = json-record / json-collection
cbor-CMW = cbor-record / cbor-collection / $cbor-tag

json-record = [
  type: media-type
  value: base64url-string
  ? ind: uint .bits cm-type
]

cbor-record = [
  type: coap-content-format-type / media-type
  value: bytes
  ? ind: uint .bits cm-type
]

cbor-tag&lt;tn, $fmt&gt; = #6.&lt;tn&gt;(bytes .cbor $fmt)

json-collection = {
  ? "__cmwc_t": ~uri / oid
  + &amp;(label: text) =&gt; json-CMW / c2j-tunnel
}

cbor-collection = {
  ? "__cmwc_t": ~uri / oid
  + &amp;(label: (int / text)) =&gt; cbor-CMW / j2c-tunnel
}

c2j-tunnel = [ "#cmw-c2j-tunnel", base64url-string ]
j2c-tunnel = [ "#cmw-j2c-tunnel", bytes ]

media-type = text .abnf ("Content-Type" .cat Content-Type-ABNF)
base64url-string = text .regexp "[A-Za-z0-9_-]+"

cm-type = &amp;(
  reference-values: 0
  endorsements: 1
  evidence: 2
  attestation-results: 3
)

coap-content-format-type = uint .size 2

oid = text .regexp "([0-2])((\\.0)|(\\.[1-9][0-9]*))*"

Content-Type-ABNF = '

Content-Type   = Media-Type-Name *( *SP ";" *SP parameter )
parameter      = token "=" ( token / quoted-string )

token          = 1*tchar
tchar          = "!" / "#" / "$" / "%" / "&amp;" / "\'" / "*"
               / "+" / "-" / "." / "^" / "_" / "`" / "|" / "~"
               / DIGIT / ALPHA
quoted-string  = %x22 *( qdtext / quoted-pair ) %x22
qdtext         = SP / %x21 / %x23-5B / %x5D-7E
quoted-pair    = "\" ( SP / VCHAR )

Media-Type-Name = type-name "/" subtype-name

type-name = restricted-name
subtype-name = restricted-name

restricted-name = restricted-name-first *126restricted-name-chars
restricted-name-first  = ALPHA / DIGIT
restricted-name-chars  = ALPHA / DIGIT / "!" / "#" /
                         "$" / "&amp;" / "-" / "^" / "_"
restricted-name-chars =/ "." ; Characters before first dot always
                             ; specify a facet name
restricted-name-chars =/ "+" ; Characters after last plus always
                             ; specify a structured syntax suffix

DIGIT     =  %x30-39           ; 0 - 9
POS-DIGIT =  %x31-39           ; 1 - 9
ALPHA     =  %x41-5A / %x61-7A ; A - Z / a - z
SP        =  %x20
VCHAR     =  %x21-7E           ; printable ASCII (no SP)
'

</pre><a href="#appendix-A-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="registering-and-using-cmws">
<section id="appendix-B">
      <h2 id="name-registering-and-using-cmws">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-registering-and-using-cmws" class="section-name selfRef">Registering and Using CMWs</a>
      </h2>
<p id="appendix-B-1"><a href="#fig-howto-cmw" class="auto internal xref">Figure 5</a> describes the registration preconditions for using
CMWs in either CMW record or CBOR tag forms.
When using CMW collection, the preconditions apply for each entry in the collection.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<span id="name-how-to-create-a-cmw"></span><div id="fig-howto-cmw">
<figure id="figure-5">
        <div id="appendix-B-2.1">
          <div class="alignLeft art-svg artwork" id="appendix-B-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="400" viewBox="0 0 400 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 40,48 L 40,80" fill="none" stroke="black"></path>
              <path d="M 56,176 L 56,424" fill="none" stroke="black"></path>
              <path d="M 80,96 L 80,152" fill="none" stroke="black"></path>
              <path d="M 80,168 L 80,424" fill="none" stroke="black"></path>
              <path d="M 96,144 L 96,176" fill="none" stroke="black"></path>
              <path d="M 104,256 L 104,288" fill="none" stroke="black"></path>
              <path d="M 120,96 L 120,144" fill="none" stroke="black"></path>
              <path d="M 168,192 L 168,232" fill="none" stroke="black"></path>
              <path d="M 168,304 L 168,376" fill="none" stroke="black"></path>
              <path d="M 184,48 L 184,80" fill="none" stroke="black"></path>
              <path d="M 200,48 L 200,80" fill="none" stroke="black"></path>
              <path d="M 224,96 L 224,144" fill="none" stroke="black"></path>
              <path d="M 240,256 L 240,288" fill="none" stroke="black"></path>
              <path d="M 248,144 L 248,176" fill="none" stroke="black"></path>
              <path d="M 264,96 L 264,152" fill="none" stroke="black"></path>
              <path d="M 264,168 L 264,328" fill="none" stroke="black"></path>
              <path d="M 264,344 L 264,424" fill="none" stroke="black"></path>
              <path d="M 288,176 L 288,328" fill="none" stroke="black"></path>
              <path d="M 288,344 L 288,424" fill="none" stroke="black"></path>
              <path d="M 296,48 L 296,80" fill="none" stroke="black"></path>
              <path d="M 304,256 L 304,288" fill="none" stroke="black"></path>
              <path d="M 344,304 L 344,320" fill="none" stroke="black"></path>
              <path d="M 392,256 L 392,288" fill="none" stroke="black"></path>
              <path d="M 56,32 L 168,32" fill="none" stroke="black"></path>
              <path d="M 216,32 L 280,32" fill="none" stroke="black"></path>
              <path d="M 56,96 L 168,96" fill="none" stroke="black"></path>
              <path d="M 216,96 L 280,96" fill="none" stroke="black"></path>
              <path d="M 112,128 L 232,128" fill="none" stroke="black"></path>
              <path d="M 72,160 L 104,160" fill="none" stroke="black"></path>
              <path d="M 240,160 L 272,160" fill="none" stroke="black"></path>
              <path d="M 112,192 L 232,192" fill="none" stroke="black"></path>
              <path d="M 120,240 L 224,240" fill="none" stroke="black"></path>
              <path d="M 320,240 L 376,240" fill="none" stroke="black"></path>
              <path d="M 120,304 L 224,304" fill="none" stroke="black"></path>
              <path d="M 320,304 L 376,304" fill="none" stroke="black"></path>
              <path d="M 184,336 L 328,336" fill="none" stroke="black"></path>
              <path d="M 112,384 L 248,384" fill="none" stroke="black"></path>
              <path d="M 96,416 L 232,416" fill="none" stroke="black"></path>
              <path d="M 24,432 L 336,432" fill="none" stroke="black"></path>
              <path d="M 8,464 L 320,464" fill="none" stroke="black"></path>
              <path d="M 8,464 L 24,432" fill="none" stroke="black"></path>
              <path d="M 96,416 L 112,384" fill="none" stroke="black"></path>
              <path d="M 232,416 L 248,384" fill="none" stroke="black"></path>
              <path d="M 320,464 L 336,432" fill="none" stroke="black"></path>
              <path d="M 56,32 C 47.16936,32 40,39.16936 40,48" fill="none" stroke="black"></path>
              <path d="M 168,32 C 176.83064,32 184,39.16936 184,48" fill="none" stroke="black"></path>
              <path d="M 216,32 C 207.16936,32 200,39.16936 200,48" fill="none" stroke="black"></path>
              <path d="M 280,32 C 288.83064,32 296,39.16936 296,48" fill="none" stroke="black"></path>
              <path d="M 56,96 C 47.16936,96 40,88.83064 40,80" fill="none" stroke="black"></path>
              <path d="M 168,96 C 176.83064,96 184,88.83064 184,80" fill="none" stroke="black"></path>
              <path d="M 216,96 C 207.16936,96 200,88.83064 200,80" fill="none" stroke="black"></path>
              <path d="M 280,96 C 288.83064,96 296,88.83064 296,80" fill="none" stroke="black"></path>
              <path d="M 112,128 C 103.16936,128 96,135.16936 96,144" fill="none" stroke="black"></path>
              <path d="M 232,128 C 240.83064,128 248,135.16936 248,144" fill="none" stroke="black"></path>
              <path d="M 72,160 C 63.16936,160 56,167.16936 56,176" fill="none" stroke="black"></path>
              <path d="M 104,160 C 112.83064,160 120,152.83064 120,144" fill="none" stroke="black"></path>
              <path d="M 240,160 C 231.16936,160 224,152.83064 224,144" fill="none" stroke="black"></path>
              <path d="M 272,160 C 280.83064,160 288,167.16936 288,176" fill="none" stroke="black"></path>
              <path d="M 112,192 C 103.16936,192 96,184.83064 96,176" fill="none" stroke="black"></path>
              <path d="M 232,192 C 240.83064,192 248,184.83064 248,176" fill="none" stroke="black"></path>
              <path d="M 120,240 C 111.16936,240 104,247.16936 104,256" fill="none" stroke="black"></path>
              <path d="M 224,240 C 232.83064,240 240,247.16936 240,256" fill="none" stroke="black"></path>
              <path d="M 320,240 C 311.16936,240 304,247.16936 304,256" fill="none" stroke="black"></path>
              <path d="M 376,240 C 384.83064,240 392,247.16936 392,256" fill="none" stroke="black"></path>
              <path d="M 120,304 C 111.16936,304 104,296.83064 104,288" fill="none" stroke="black"></path>
              <path d="M 224,304 C 232.83064,304 240,296.83064 240,288" fill="none" stroke="black"></path>
              <path d="M 320,304 C 311.16936,304 304,296.83064 304,288" fill="none" stroke="black"></path>
              <path d="M 376,304 C 384.83064,304 392,296.83064 392,288" fill="none" stroke="black"></path>
              <path d="M 184,336 C 175.16936,336 168,343.16936 168,352" fill="none" stroke="black"></path>
              <path d="M 328,336 C 336.83064,336 344,328.83064 344,320" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="296,424 284,418.4 284,429.6" fill="black" transform="rotate(90,288,424)"></polygon>
              <path class="jump" d="M 288,344 C 282,344 282,328 288,328" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="272,424 260,418.4 260,429.6" fill="black" transform="rotate(90,264,424)"></polygon>
              <path class="jump" d="M 264,344 C 258,344 258,328 264,328" fill="none" stroke="black"></path>
              <path class="jump" d="M 264,168 C 258,168 258,152 264,152" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="176,376 164,370.4 164,381.6" fill="black" transform="rotate(90,168,376)"></polygon>
              <polygon class="arrowhead" points="176,232 164,226.4 164,237.6" fill="black" transform="rotate(90,168,232)"></polygon>
              <polygon class="arrowhead" points="88,424 76,418.4 76,429.6" fill="black" transform="rotate(90,80,424)"></polygon>
              <path class="jump" d="M 80,168 C 74,168 74,152 80,152" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="64,424 52,418.4 52,429.6" fill="black" transform="rotate(90,56,424)"></polygon>
              <g class="text">
                <text x="72" y="52">Reuse</text>
                <text x="136" y="52">EAT/CoRIM</text>
                <text x="244" y="52">Register</text>
                <text x="72" y="68">media</text>
                <text x="128" y="68">type(s)</text>
                <text x="224" y="68">new</text>
                <text x="264" y="68">media</text>
                <text x="56" y="84">+</text>
                <text x="96" y="84">profile</text>
                <text x="228" y="84">type</text>
                <text x="172" y="148">Register</text>
                <text x="152" y="164">new</text>
                <text x="188" y="164">CoAP</text>
                <text x="172" y="180">Content-Format</text>
                <text x="168" y="260">Automatically</text>
                <text x="348" y="260">Existing</text>
                <text x="140" y="276">derive</text>
                <text x="188" y="276">CBOR</text>
                <text x="332" y="276">CBOR</text>
                <text x="128" y="292">tag</text>
                <text x="184" y="292">[RFC9277]</text>
                <text x="328" y="292">tag</text>
                <text x="140" y="404">CBOR</text>
                <text x="176" y="404">tag</text>
                <text x="208" y="404">CMW</text>
                <text x="168" y="452">CMW</text>
              </g>
            </svg><a href="#appendix-B-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-how-to-create-a-cmw" class="selfRef">How To Create a CMW</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="open-issues">
<section id="appendix-C">
      <h2 id="name-open-issues">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-open-issues" class="section-name selfRef">Open Issues</a>
      </h2>
<p id="appendix-C-1">The list of currently open issues for this documents can be found at
<span><a href="https://github.com/thomas-fossati/draft-ftbs-rats-msg-wrap/issues">https://github.com/thomas-fossati/draft-ftbs-rats-msg-wrap/issues</a></span>.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2"><span class="cref">Note to RFC Editor: please remove before publication.</span><a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">The authors would like to thank
Brian Campbell,
Carl Wallace,
Carsten Bormann,
Dionna Glaze,
<span class="contact-name">Ionuț Mihalcea</span>
Laurence Lundblade,
Michael B. Jones,
Mohit Sethi,
Russ Housley,
and
Tom Jones
for their reviews and suggestions.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The definition of a CMW collection has been modelled on a proposal originally made by Simon Frost for an EAT-based Evidence collection type.  The CMW collection intentionally attains binary compatibility with Simon's design and aims at superseding it by also generalizing on the allowed Evidence formats.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@sit.fraunhofer.de" class="email">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ned Smith</span></div>
<div dir="auto" class="left"><span class="org">Intel</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ned.smith@intel.com" class="email">ned.smith@intel.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas.fossati@linaro.org" class="email">thomas.fossati@linaro.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
